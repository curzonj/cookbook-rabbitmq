%%%
%% Generated by Chef
%%%

[
  {rabbit, [
<% if node[:rabbitmq][:cluster] && node[:rabbitmq][:cluster_disk_nodes] -%>
    {cluster_nodes, [<%= node[:rabbitmq][:cluster_disk_nodes].map{|n| "\'#{n}\'"}.join(',') %>]},
<% end %>

<% if node[:rabbitmq][:ssl] -%>
    {ssl_listeners, [<%= node[:rabbitmq][:ssl_port] %>]},
    {ssl_options, [{cacertfile,"<%= node[:rabbitmq][:ssl_cacert] %>"},
                    {certfile,"<%= node[:rabbitmq][:ssl_cert] %>"},
                    {keyfile,"<%= node[:rabbitmq][:ssl_key] %>"},
                    {verify,verify_none},
                    {fail_if_no_peer_cert,false}]},
<% end %>

%% Mostly just to have something that will
%% always be there and doesnt end with a comma
    { tcp_listeners, [5672] }
  ]},

  {rabbitmq_stomp, [{tcp_listeners, [61613]},
                    {ssl_listeners, [61614]}]}

].
